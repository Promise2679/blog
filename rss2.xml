<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Xenlyra的小站</title>
    <link>https://blog.xenlyra.cc/</link>
    
    <image>
      <url>https://blog.xenlyra.cc/icon.png</url>
      <title>Xenlyra的小站</title>
      <link>https://blog.xenlyra.cc/</link>
    </image>
    
    <atom:link href="https://blog.xenlyra.cc/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description></description>
    <pubDate>Sun, 14 Dec 2025 05:30:58 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>Advent of Code 2025 Writeup</title>
      <link>https://blog.xenlyra.cc/aoc2025/</link>
      <guid>https://blog.xenlyra.cc/aoc2025/</guid>
      <pubDate>Sat, 13 Dec 2025 04:26:07 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;这是一个每年 12 月举办的编程活动，每天都会开放一个程序设计题，不过只有一个样例，而且没有任何语言和时间复杂度的限制，只要算对答案就可以了。每道题有两个部分，附带圣诞节主题的小剧情。总体来说活动性质偏娱乐，所以难度不算太高。可以用它来熟悉一些新语言，我用的是 JavaSc</description>
        
      
      
      
      <content:encoded><![CDATA[<p>这是一个每年 12 月举办的编程活动，每天都会开放一个程序设计题，不过只有一个样例，而且没有任何语言和时间复杂度的限制，只要算对答案就可以了。每道题有两个部分，附带圣诞节主题的小剧情。总体来说活动性质偏娱乐，所以难度不算太高。可以用它来熟悉一些新语言，我用的是 JavaScript。</p><p>传送门：<a href="https://adventofcode.com/">https://adventofcode.com/</a></p><p>今年一共放出了 12 道题目，没做出来的题目有第九天和第十天的 Part 2，以及最后一天所有部分。可以看到后面会逐渐开始上强度。</p><h2 id="day-1-secret-entrance">Day 1: Secret Entrance</h2><h3 id="part-1">Part 1</h3><p>求最终值为 0 的次数，比较简单。L 代表减，R 代表加，对最终结果求模判断一下就好了</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>)</span><br><span class="line">  .<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">  .<span class="title function_">split</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> [item.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">1</span>), <span class="title class_">Number</span>(item.<span class="title function_">slice</span>(<span class="number">1</span>))]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> curr = <span class="number">50</span>;</span><br><span class="line"><span class="keyword">const</span> ans = data.<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, item</span>) =&gt;</span> &#123;</span><br><span class="line">  curr = (((item[<span class="number">0</span>] === <span class="string">&quot;L&quot;</span> ? curr - item[<span class="number">1</span>] : curr + item[<span class="number">1</span>]) % <span class="number">100</span>) + <span class="number">100</span>) % <span class="number">100</span>;</span><br><span class="line">  <span class="keyword">return</span> curr === <span class="number">0</span> ? acc + <span class="number">1</span> : acc;</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ans);</span><br><span class="line"><span class="comment">// 1154</span></span><br></pre></td></tr></table></figure><h3 id="part-2">Part 2</h3><p>求转动过程中经过刻度 0 的总次数。</p><p>稍微转换了下思路，每经过一个 100 的倍数，都相当于经过一次 0 刻度，计算完之后再取模，转换成最终所在的刻度</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>)</span><br><span class="line">  .<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">  .<span class="title function_">split</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> [item.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">1</span>), <span class="title class_">Number</span>(item.<span class="title function_">slice</span>(<span class="number">1</span>))]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> curr = <span class="number">50</span>;</span><br><span class="line"><span class="keyword">const</span> ans = data.<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, item</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (item[<span class="number">0</span>] === <span class="string">&quot;L&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (curr === <span class="number">0</span>) &#123;</span><br><span class="line">      curr -= item[<span class="number">1</span>];</span><br><span class="line">      acc += -<span class="title class_">Math</span>.<span class="title function_">trunc</span>(curr / <span class="number">100</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      curr -= item[<span class="number">1</span>];</span><br><span class="line">      <span class="keyword">if</span> (curr &lt;= <span class="number">0</span>) acc += <span class="number">1</span> - <span class="title class_">Math</span>.<span class="title function_">trunc</span>(curr / <span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    curr += item[<span class="number">1</span>];</span><br><span class="line">    acc += <span class="title class_">Math</span>.<span class="title function_">trunc</span>(curr / <span class="number">100</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  curr = ((curr % <span class="number">100</span>) + <span class="number">100</span>) % <span class="number">100</span>;</span><br><span class="line">  <span class="keyword">return</span> acc;</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ans);</span><br><span class="line"><span class="comment">// 6819</span></span><br></pre></td></tr></table></figure><h2 id="day-2-gift-shop">Day 2: Gift Shop</h2><h3 id="part-1-1">Part 1</h3><p>重复<strong>两次</strong>的字符串组成的数字被视为无效数字，求出区间内无效数字之和。</p><p>首先奇数长度的数字肯定是有效的，字符串重复两次怎么都是偶数嘛。对于偶数长度的数字，只要判断前半段字符串和后半段是否相等就可以了。这样的判断对于奇数同样有效，所以可以省掉判断奇偶的步骤</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>)</span><br><span class="line">  .<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">  .<span class="title function_">split</span>(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="title function_">split</span>(<span class="string">&quot;-&quot;</span>).<span class="title function_">map</span>(<span class="function"><span class="params">value</span> =&gt;</span> <span class="title class_">Number</span>(value)));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ans = data.<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, item</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = item[<span class="number">0</span>]; i &lt;= item[<span class="number">1</span>]; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> s = i.<span class="title function_">toString</span>();</span><br><span class="line">    <span class="keyword">const</span> halfLength = <span class="title class_">Math</span>.<span class="title function_">floor</span>(s.<span class="property">length</span> / <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> (s.<span class="title function_">slice</span>(<span class="number">0</span>, halfLength) === s.<span class="title function_">slice</span>(halfLength)) &#123;</span><br><span class="line">      sum += i;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> acc + sum;</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ans);</span><br><span class="line"><span class="comment">// 13108371860</span></span><br></pre></td></tr></table></figure><h3 id="part-2-1">Part 2</h3><p>这下不强制要求重复两次了，只要能被一个重复字符串拼接出来都被视为无效数字。枚举一下子字符串长度就可以了</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>)</span><br><span class="line">  .<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">  .<span class="title function_">split</span>(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="title function_">split</span>(<span class="string">&quot;-&quot;</span>).<span class="title function_">map</span>(<span class="function"><span class="params">value</span> =&gt;</span> <span class="title class_">Number</span>(value)));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">isValid</span> = (<span class="params">s, l</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (s.<span class="property">length</span> % l !== <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; s.<span class="property">length</span>; i += l) &#123;</span><br><span class="line">    <span class="keyword">if</span> (s.<span class="title function_">slice</span>(i, i + l) !== s.<span class="title function_">slice</span>(<span class="number">0</span>, l)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ans = data.<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, item</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = item[<span class="number">0</span>]; i &lt;= item[<span class="number">1</span>]; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> s = i.<span class="title function_">toString</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">1</span>; j &lt;= <span class="title class_">Math</span>.<span class="title function_">floor</span>(s.<span class="property">length</span> / <span class="number">2</span>); j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!<span class="title function_">isValid</span>(s, j)) <span class="keyword">continue</span>;</span><br><span class="line">      sum += i;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> acc + sum;</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ans);</span><br><span class="line"><span class="comment">// 22471660255</span></span><br></pre></td></tr></table></figure><h2 id="day-3-lobby">Day 3: Lobby</h2><h3 id="part-1-2">Part 1</h3><p>找到两个字符拼接成的最大两位数，不能变换顺序，对每个这样的两位数求和。</p><p>算是一个贪心吧，找到前 n - 1 个字符中最大的一个，保留最后一个防止取不到个位数，同样大取序列较小的。个位数就从这个序列之后的部分中取最大。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>).<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>).<span class="title function_">split</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ans = data.<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, item</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> a = <span class="title class_">Math</span>.<span class="title function_">max</span>(...item.<span class="title function_">slice</span>(<span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">  <span class="keyword">const</span> b = <span class="title class_">Math</span>.<span class="title function_">max</span>(...item.<span class="title function_">slice</span>(item.<span class="title function_">indexOf</span>(a) + <span class="number">1</span>));</span><br><span class="line">  <span class="keyword">return</span> acc + a * <span class="number">10</span> + b;</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ans);</span><br><span class="line"><span class="comment">// 17316</span></span><br></pre></td></tr></table></figure><h3 id="part-2-2">Part 2</h3><p>同样的要求，不过现在变成 12 个字符了。</p><p>乍一看很唬人，其实是同样的策略，不过需要注意一下边界条件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>).<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>).<span class="title function_">split</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ans = data.<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, item</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="number">0</span>, pos = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt;= <span class="number">12</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> subItem = i !== <span class="number">12</span> ? item.<span class="title function_">slice</span>(pos, i - <span class="number">12</span>) : item.<span class="title function_">slice</span>(pos);</span><br><span class="line">    <span class="keyword">const</span> value = <span class="title class_">Math</span>.<span class="title function_">max</span>(...subItem);</span><br><span class="line">    pos += subItem.<span class="title function_">indexOf</span>(value) + <span class="number">1</span>;</span><br><span class="line">    sum = sum * <span class="number">10</span> + value;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> acc + sum;</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ans);</span><br><span class="line"><span class="comment">// 171741365473332</span></span><br></pre></td></tr></table></figure><h2 id="day-4-printing-department">Day 4: Printing Department</h2><h3 id="part-1-3">Part 1</h3><p>暴力穷举</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>)</span><br><span class="line">  .<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">  .<span class="title function_">split</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> [<span class="string">&quot;.&quot;</span>, ...item, <span class="string">&quot;.&quot;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> width = data[<span class="number">0</span>].<span class="property">length</span>;</span><br><span class="line"><span class="keyword">const</span> height = data.<span class="property">length</span>;</span><br><span class="line"></span><br><span class="line">data.<span class="title function_">unshift</span>(<span class="title class_">Array</span>(width).<span class="title function_">fill</span>(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">data.<span class="title function_">push</span>(<span class="title class_">Array</span>(width).<span class="title function_">fill</span>(<span class="string">&quot;.&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">const</span> dir = [[-<span class="number">1</span>, -<span class="number">1</span>], [-<span class="number">1</span>, <span class="number">0</span>], [-<span class="number">1</span>, <span class="number">1</span>], [<span class="number">0</span>, -<span class="number">1</span>], [<span class="number">0</span>, <span class="number">1</span>], [<span class="number">1</span>, -<span class="number">1</span>], [<span class="number">1</span>, <span class="number">0</span>], [<span class="number">1</span>, <span class="number">1</span>]];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt;= height; i++) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">1</span>; j &lt;= width - <span class="number">2</span>; j++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (data[i][j] === <span class="string">&quot;.&quot;</span>) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">const</span> num = dir.<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, item</span>) =&gt;</span> (data[i + item[<span class="number">0</span>]][j + item[<span class="number">1</span>]] === <span class="string">&quot;@&quot;</span> ? acc + <span class="number">1</span> : acc), <span class="number">0</span>);</span><br><span class="line">    ans += num &lt; <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ans);</span><br><span class="line"><span class="comment">// 1419</span></span><br></pre></td></tr></table></figure><h3 id="part-2-3">Part 2</h3><p>跟 Part 1 一样，套一层循环就好了</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>)</span><br><span class="line">  .<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">  .<span class="title function_">split</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> [<span class="string">&quot;.&quot;</span>, ...item, <span class="string">&quot;.&quot;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> width = data[<span class="number">0</span>].<span class="property">length</span>;</span><br><span class="line"><span class="keyword">const</span> height = data.<span class="property">length</span>;</span><br><span class="line"></span><br><span class="line">data.<span class="title function_">unshift</span>(<span class="title class_">Array</span>(width).<span class="title function_">fill</span>(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">data.<span class="title function_">push</span>(<span class="title class_">Array</span>(width).<span class="title function_">fill</span>(<span class="string">&quot;.&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ans = <span class="number">0</span>, sum;</span><br><span class="line"><span class="keyword">const</span> dir = [[-<span class="number">1</span>, -<span class="number">1</span>], [-<span class="number">1</span>, <span class="number">0</span>], [-<span class="number">1</span>, <span class="number">1</span>], [<span class="number">0</span>, -<span class="number">1</span>], [<span class="number">0</span>, <span class="number">1</span>], [<span class="number">1</span>, -<span class="number">1</span>], [<span class="number">1</span>, <span class="number">0</span>], [<span class="number">1</span>, <span class="number">1</span>]];</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">const</span> x = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt;= height; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">1</span>; j &lt;= width - <span class="number">2</span>; j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (data[i][j] === <span class="string">&quot;.&quot;</span>) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">const</span> num = dir.<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, item</span>) =&gt;</span> (data[i + item[<span class="number">0</span>]][j + item[<span class="number">1</span>]] === <span class="string">&quot;@&quot;</span> ? acc + <span class="number">1</span> : acc), <span class="number">0</span>);</span><br><span class="line">      <span class="keyword">if</span> (num &gt;= <span class="number">4</span>) <span class="keyword">continue</span>;</span><br><span class="line">      sum++;</span><br><span class="line">      x.<span class="title function_">push</span>([i, j]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  ans += sum;</span><br><span class="line">  x.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> (data[item[<span class="number">0</span>]][item[<span class="number">1</span>]] = <span class="string">&quot;.&quot;</span>));</span><br><span class="line">&#125; <span class="keyword">while</span> (sum !== <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ans);</span><br><span class="line"><span class="comment">// 8739</span></span><br></pre></td></tr></table></figure><h2 id="day-5-cafeteria">Day 5: Cafeteria</h2><h3 id="part-1-4">Part 1</h3><p>找给定数据中不在有效区间内的数据总量。</p><p>一开始想直接用集合，结果爆栈了，然后想到只要枚举所有区间就行</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> data = fs</span><br><span class="line">  .<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">  .<span class="title function_">split</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="title function_">split</span>(<span class="string">&quot;-&quot;</span>).<span class="title function_">map</span>(<span class="function"><span class="params">value</span> =&gt;</span> <span class="title class_">Number</span>(value)));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> question = fs</span><br><span class="line">  .<span class="title function_">readFileSync</span>(<span class="string">&quot;2.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">  .<span class="title function_">split</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> <span class="title class_">Number</span>(item));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ans = question.<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, value</span>) =&gt;</span> (data.<span class="title function_">some</span>(<span class="function"><span class="params">item</span> =&gt;</span> value &gt;= item[<span class="number">0</span>] &amp;&amp; value &lt;= item[<span class="number">1</span>]) ? acc + <span class="number">1</span> : acc), <span class="number">0</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ans);</span><br><span class="line"><span class="comment">// 607</span></span><br></pre></td></tr></table></figure><h3 id="part-2-4">Part 2</h3><p>求区间内有效数据的总量</p><p>其实就是合并区间的问题，直接上双重循环，有交集就合并，否则直接下一个。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> data = fs</span><br><span class="line">  .<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">  .<span class="title function_">split</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="title function_">split</span>(<span class="string">&quot;-&quot;</span>).<span class="title function_">map</span>(<span class="function"><span class="params">value</span> =&gt;</span> <span class="title class_">Number</span>(value)));</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> j = i + <span class="number">1</span>; j &lt; data.<span class="property">length</span>; j++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (data[j][<span class="number">0</span>] &gt; data[i][<span class="number">1</span>] || data[j][<span class="number">1</span>] &lt; data[i][<span class="number">0</span>]) <span class="keyword">continue</span>;</span><br><span class="line">    data[i][<span class="number">0</span>] = <span class="title class_">Math</span>.<span class="title function_">min</span>(data[i][<span class="number">0</span>], data[j][<span class="number">0</span>]);</span><br><span class="line">    data[i][<span class="number">1</span>] = <span class="title class_">Math</span>.<span class="title function_">max</span>(data[i][<span class="number">1</span>], data[j][<span class="number">1</span>]);</span><br><span class="line">    data.<span class="title function_">splice</span>(j, <span class="number">1</span>);</span><br><span class="line">    j = i;</span><br><span class="line">  &#125;</span><br><span class="line">  ans += data[i][<span class="number">1</span>] - data[i][<span class="number">0</span>] + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ans);</span><br><span class="line"><span class="comment">// 342433357244012</span></span><br></pre></td></tr></table></figure><h2 id="day-6-trash-compactor">Day 6: Trash Compactor</h2><h3 id="part-1-5">Part 1</h3><p>这一天的题目挺有意思的。</p><p>这一部分让我们竖着算，虽然有点反直觉，不过调一调还是能写出来</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>)</span><br><span class="line">  .<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">  .<span class="title function_">split</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function">(<span class="params">item, index</span>) =&gt;</span></span><br><span class="line">    item</span><br><span class="line">      .<span class="title function_">split</span>(<span class="string">&quot; &quot;</span>)</span><br><span class="line">      .<span class="title function_">filter</span>(<span class="function"><span class="params">value</span> =&gt;</span> value !== <span class="string">&quot;&quot;</span>)</span><br><span class="line">      .<span class="title function_">map</span>(<span class="function"><span class="params">value</span> =&gt;</span> (index === <span class="number">4</span> ? value : <span class="title class_">Number</span>(value)))</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> data[<span class="number">0</span>]) &#123;</span><br><span class="line">  ans += data[<span class="number">4</span>][i] === <span class="string">&quot;+&quot;</span> </span><br><span class="line">    ? data[<span class="number">0</span>][i] + data[<span class="number">1</span>][i] + data[<span class="number">2</span>][i] + data[<span class="number">3</span>][i]</span><br><span class="line">    : data[<span class="number">0</span>][i] * data[<span class="number">1</span>][i] * data[<span class="number">2</span>][i] * data[<span class="number">3</span>][i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ans);</span><br><span class="line"><span class="comment">// 4309240495780</span></span><br></pre></td></tr></table></figure><h3 id="part-2-5">Part 2</h3><p>仍然是竖着算，不过要精确到每一位了。只好自己把竖式掰成横的</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> raw = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>)</span><br><span class="line">  .<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">  .<span class="title function_">split</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> [...item]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> data = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> raw[<span class="number">0</span>]) &#123;</span><br><span class="line">  <span class="keyword">if</span> (raw[<span class="number">4</span>][i] !== <span class="string">&quot; &quot;</span>) data.<span class="title function_">push</span>([raw[<span class="number">4</span>][i], []]);</span><br><span class="line">  <span class="keyword">let</span> num = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (raw[j][i] === <span class="string">&quot; &quot;</span>) <span class="keyword">continue</span>;</span><br><span class="line">    num = num * <span class="number">10</span> + <span class="title class_">Number</span>(raw[j][i]);</span><br><span class="line">  &#125;</span><br><span class="line">  num !== <span class="number">0</span> &amp;&amp; data.<span class="title function_">at</span>(-<span class="number">1</span>)[<span class="number">1</span>].<span class="title function_">push</span>(num);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ans = data.<span class="title function_">reduce</span>(</span><br><span class="line">  <span class="function">(<span class="params">acc, item</span>) =&gt;</span> acc + (item[<span class="number">0</span>] === <span class="string">&quot;+&quot;</span> ? item[<span class="number">1</span>].<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, item</span>) =&gt;</span> acc + item, <span class="number">0</span>) : item[<span class="number">1</span>].<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, item</span>) =&gt;</span> acc * item, <span class="number">1</span>)),</span><br><span class="line">  <span class="number">0</span></span><br><span class="line">);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ans);</span><br><span class="line"><span class="comment">// 9170286552289</span></span><br></pre></td></tr></table></figure><h2 id="day-7-laboratories">Day 7: Laboratories</h2><h3 id="part-1-6">Part 1</h3><p>用集合模拟</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>).<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>).<span class="title function_">split</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">const</span> st = <span class="keyword">new</span> <span class="title class_">Set</span>().<span class="title function_">add</span>(data[<span class="number">0</span>].<span class="title function_">indexOf</span>(<span class="string">&quot;S&quot;</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">2</span>; i &lt; data.<span class="property">length</span>; i += <span class="number">2</span>) &#123;</span><br><span class="line">  st.<span class="title function_">forEach</span>(<span class="function"><span class="params">index</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (data[i][index] === <span class="string">&quot;.&quot;</span>) <span class="keyword">return</span>;</span><br><span class="line">    st.<span class="title function_">add</span>(index + <span class="number">1</span>);</span><br><span class="line">    st.<span class="title function_">add</span>(index - <span class="number">1</span>);</span><br><span class="line">    st.<span class="title function_">delete</span>(index);</span><br><span class="line">    ans++;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ans);</span><br><span class="line"><span class="comment">// 1585</span></span><br></pre></td></tr></table></figure><h3 id="part-2-6">Part 2</h3><p>直接 dfs 时间复杂度会拉到指数级，需要配合记忆化搜索</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>).<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>).<span class="title function_">split</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> d = &#123;&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">dfs</span> = (<span class="params">pos, layer</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (layer &gt;= data.<span class="property">length</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> (d[<span class="string">`<span class="subst">$&#123;layer&#125;</span>-<span class="subst">$&#123;pos&#125;</span>`</span>]) <span class="keyword">return</span> d[<span class="string">`<span class="subst">$&#123;layer&#125;</span>-<span class="subst">$&#123;pos&#125;</span>`</span>];</span><br><span class="line">  d[<span class="string">`<span class="subst">$&#123;layer&#125;</span>-<span class="subst">$&#123;pos&#125;</span>`</span>] = data[layer][pos] === <span class="string">&quot;.&quot;</span> ? <span class="title function_">dfs</span>(pos, layer + <span class="number">2</span>) : <span class="title function_">dfs</span>(pos - <span class="number">1</span>, layer + <span class="number">2</span>) + <span class="title function_">dfs</span>(pos + <span class="number">1</span>, layer + <span class="number">2</span>);</span><br><span class="line">  <span class="keyword">return</span> d[<span class="string">`<span class="subst">$&#123;layer&#125;</span>-<span class="subst">$&#123;pos&#125;</span>`</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ans = <span class="title function_">dfs</span>(data[<span class="number">0</span>].<span class="title function_">indexOf</span>(<span class="string">&quot;S&quot;</span>), <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ans);</span><br><span class="line"><span class="comment">// 16716444407407</span></span><br></pre></td></tr></table></figure><h2 id="day-8-playground">Day 8: Playground</h2><h3 id="part-1-7">Part 1</h3><p>存储每个接线盒之间的距离并排序，然后使用并查集</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> data = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>)</span><br><span class="line">  .<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">  .<span class="title function_">split</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="title function_">split</span>(<span class="string">&quot;,&quot;</span>).<span class="title function_">map</span>(<span class="function"><span class="params">value</span> =&gt;</span> <span class="title class_">Number</span>(value)));</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> d = &#123;&#125;;</span><br><span class="line"><span class="keyword">const</span> size = data.<span class="property">length</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> j = i + <span class="number">1</span>; j &lt; size; j++) &#123;</span><br><span class="line">    d[<span class="string">`<span class="subst">$&#123;i&#125;</span>-<span class="subst">$&#123;j&#125;</span>`</span>] = <span class="title class_">Math</span>.<span class="title function_">hypot</span>(data[i][<span class="number">0</span>] - data[j][<span class="number">0</span>], data[i][<span class="number">1</span>] - data[j][<span class="number">1</span>], data[i][<span class="number">2</span>] - data[j][<span class="number">2</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">d = <span class="title class_">Object</span>.<span class="title function_">entries</span>(d)</span><br><span class="line">  .<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a[<span class="number">1</span>] - b[<span class="number">1</span>])</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> [item[<span class="number">0</span>].<span class="title function_">split</span>(<span class="string">&quot;-&quot;</span>).<span class="title function_">map</span>(<span class="function"><span class="params">value</span> =&gt;</span> <span class="title class_">Number</span>(value)), item[<span class="number">1</span>]]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Unionfind</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">n</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">p</span> = <span class="title class_">Array</span>.<span class="title function_">from</span>(&#123; <span class="attr">length</span>: n &#125;, <span class="function">(<span class="params">_, index</span>) =&gt;</span> index);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">query</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">p</span>[x] == x ? x : (<span class="variable language_">this</span>.<span class="property">p</span>[x] = <span class="variable language_">this</span>.<span class="title function_">query</span>(<span class="variable language_">this</span>.<span class="property">p</span>[x]));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">merge</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">p</span>[<span class="variable language_">this</span>.<span class="title function_">query</span>(x)] = <span class="variable language_">this</span>.<span class="title function_">query</span>(y);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> uf = <span class="keyword">new</span> <span class="title class_">Unionfind</span>(size);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">const</span> [a, b] = d[i][<span class="number">0</span>];</span><br><span class="line">  uf.<span class="title function_">merge</span>(a, b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> cnt = <span class="title class_">Array</span>(size).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">  cnt[uf.<span class="title function_">query</span>(i)]++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cnt = cnt.<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> b - a)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(cnt[<span class="number">0</span>] * cnt[<span class="number">1</span>] * cnt[<span class="number">2</span>])</span><br><span class="line"><span class="comment">// 153328</span></span><br></pre></td></tr></table></figure><h3 id="part-2-7">Part 2</h3><p>继续按照原来的方式连线直到所有接线盒都在一个集合内</p><p>有一个坑点是如果两个盒本来就在一个集合内，则不需要累加到答案中</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> data = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>)</span><br><span class="line">  .<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">  .<span class="title function_">split</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="title function_">split</span>(<span class="string">&quot;,&quot;</span>).<span class="title function_">map</span>(<span class="function"><span class="params">value</span> =&gt;</span> <span class="title class_">Number</span>(value)));</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> d = &#123;&#125;;</span><br><span class="line"><span class="keyword">const</span> size = data.<span class="property">length</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> j = i + <span class="number">1</span>; j &lt; size; j++) &#123;</span><br><span class="line">    d[<span class="string">`<span class="subst">$&#123;i&#125;</span>-<span class="subst">$&#123;j&#125;</span>`</span>] = <span class="title class_">Math</span>.<span class="title function_">hypot</span>(data[i][<span class="number">0</span>] - data[j][<span class="number">0</span>], data[i][<span class="number">1</span>] - data[j][<span class="number">1</span>], data[i][<span class="number">2</span>] - data[j][<span class="number">2</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">d = <span class="title class_">Object</span>.<span class="title function_">entries</span>(d)</span><br><span class="line">  .<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a[<span class="number">1</span>] - b[<span class="number">1</span>])</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> [item[<span class="number">0</span>].<span class="title function_">split</span>(<span class="string">&quot;-&quot;</span>).<span class="title function_">map</span>(<span class="function"><span class="params">value</span> =&gt;</span> <span class="title class_">Number</span>(value)), item[<span class="number">1</span>]]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Unionfind</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">n</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">p</span> = <span class="title class_">Array</span>.<span class="title function_">from</span>(&#123; <span class="attr">length</span>: n &#125;, <span class="function">(<span class="params">_, index</span>) =&gt;</span> index);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">query</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">p</span>[x] == x ? x : (<span class="variable language_">this</span>.<span class="property">p</span>[x] = <span class="variable language_">this</span>.<span class="title function_">query</span>(<span class="variable language_">this</span>.<span class="property">p</span>[x]));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">merge</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">p</span>[<span class="variable language_">this</span>.<span class="title function_">query</span>(x)] = <span class="variable language_">this</span>.<span class="title function_">query</span>(y);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ans;</span><br><span class="line"><span class="keyword">const</span> cnt = <span class="title class_">Array</span>(size).<span class="title function_">fill</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">const</span> uf = <span class="keyword">new</span> <span class="title class_">Unionfind</span>(size);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; ; i++) &#123;</span><br><span class="line">  <span class="keyword">const</span> [a, b] = d[i][<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">if</span> (uf.<span class="title function_">query</span>(a) === uf.<span class="title function_">query</span>(b)) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> num = cnt[uf.<span class="title function_">query</span>(a)] + cnt[uf.<span class="title function_">query</span>(b)];</span><br><span class="line">  uf.<span class="title function_">merge</span>(a, b);</span><br><span class="line">  cnt[uf.<span class="title function_">query</span>(a)] = num;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (i &gt;= <span class="number">1000</span> &amp;&amp; num &gt;= size) &#123;</span><br><span class="line">    ans = data[a][<span class="number">0</span>] * data[b][<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ans);</span><br><span class="line"><span class="comment">// 6095621910</span></span><br></pre></td></tr></table></figure><h2 id="day-9-movie-theater">Day 9: Movie Theater</h2><h3 id="part-1-8">Part 1</h3><p>穷举</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>)</span><br><span class="line">  .<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">  .<span class="title function_">split</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="title function_">split</span>(<span class="string">&quot;,&quot;</span>).<span class="title function_">map</span>(<span class="function"><span class="params">value</span> =&gt;</span> <span class="title class_">Number</span>(value)));</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> j = i + <span class="number">1</span>; j &lt; data.<span class="property">length</span>; j++) &#123;</span><br><span class="line">    ans = <span class="title class_">Math</span>.<span class="title function_">max</span>(ans, <span class="title class_">Math</span>.<span class="title function_">abs</span>((data[i][<span class="number">0</span>] - data[j][<span class="number">0</span>] + <span class="number">1</span>) * (data[i][<span class="number">1</span>] - data[j][<span class="number">1</span>] + <span class="number">1</span>)))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ans);</span><br><span class="line"><span class="comment">// 4774877510</span></span><br></pre></td></tr></table></figure><h2 id="day-10-factory">Day 10: Factory</h2><h3 id="part-1-9">Part 1</h3><p>注意到最优解法每个按钮最多只按一次，故使用位运算</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>)</span><br><span class="line">  .<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">  .<span class="title function_">split</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> [</span><br><span class="line">    item</span><br><span class="line">      .<span class="title function_">slice</span>(<span class="number">1</span>, item.<span class="title function_">indexOf</span>(<span class="string">&quot;]&quot;</span>))</span><br><span class="line">      .<span class="title function_">split</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">      .<span class="title function_">map</span>(<span class="function"><span class="params">value</span> =&gt;</span> <span class="title class_">Number</span>(value === <span class="string">&quot;#&quot;</span>)),</span><br><span class="line">    item</span><br><span class="line">      .<span class="title function_">slice</span>(item.<span class="title function_">indexOf</span>(<span class="string">&quot;(&quot;</span>), item.<span class="title function_">lastIndexOf</span>(<span class="string">&quot;)&quot;</span>) + <span class="number">1</span>)</span><br><span class="line">      .<span class="title function_">split</span>(<span class="string">&quot; &quot;</span>)</span><br><span class="line">      .<span class="title function_">map</span>(<span class="function"><span class="params">value</span> =&gt;</span></span><br><span class="line">        value</span><br><span class="line">          .<span class="title function_">slice</span>(<span class="number">1</span>, -<span class="number">1</span>)</span><br><span class="line">          .<span class="title function_">split</span>(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">          .<span class="title function_">map</span>(<span class="function"><span class="params">v</span> =&gt;</span> <span class="title class_">Number</span>(v))</span><br><span class="line">      ),</span><br><span class="line">  ]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ans = data.<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, item</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> minn = <span class="title class_">Infinity</span>;</span><br><span class="line">  <span class="keyword">const</span> [target, btns] = item;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">1</span> &lt;&lt; btns.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> tmp = <span class="title class_">Array</span>(target.<span class="property">length</span>).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">let</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; btns.<span class="property">length</span>; j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (((i &gt;&gt; j) &amp; <span class="number">1</span>) === <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> k = <span class="number">0</span>; k &lt; btns[j].<span class="property">length</span>; k++) &#123;</span><br><span class="line">        tmp[btns[j][k]] ^= <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      cnt++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!tmp.<span class="title function_">some</span>(<span class="function">(<span class="params">item, index</span>) =&gt;</span> item !== target[index])) &#123;</span><br><span class="line">      minn = <span class="title class_">Math</span>.<span class="title function_">min</span>(cnt, minn);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> acc + minn;</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ans);</span><br><span class="line"><span class="comment">// 438</span></span><br></pre></td></tr></table></figure><h2 id="day-11-reactor">Day 11: Reactor</h2><h3 id="part-1-10">Part 1</h3><p>因为是 DAG，所以直接搜索就可以。代码跟第七天 Part 2 差不多。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>)</span><br><span class="line">  .<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">  .<span class="title function_">split</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> [item.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">3</span>), item.<span class="title function_">slice</span>(<span class="number">5</span>).<span class="title function_">split</span>(<span class="string">&quot; &quot;</span>)]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> d = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">dfs</span> = p =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (p === <span class="string">&quot;out&quot;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> (d[p]) <span class="keyword">return</span> d[p];</span><br><span class="line"></span><br><span class="line">  d[p] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">const</span> idx = data.<span class="title function_">findIndex</span>(<span class="function"><span class="params">item</span> =&gt;</span> item[<span class="number">0</span>] === p);</span><br><span class="line"></span><br><span class="line">  data[idx][<span class="number">1</span>].<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    d[p] += <span class="title function_">dfs</span>(item);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> d[p];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ans = <span class="title function_">dfs</span>(<span class="string">&quot;you&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ans);</span><br><span class="line"><span class="comment">// 758</span></span><br></pre></td></tr></table></figure><h3 id="part-2-8">Part 2</h3><p>要求路径必须经过两个中间点。对是否经过这两点进行状态压缩，通过 mask 进行状态传递</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>)</span><br><span class="line">  .<span class="title function_">readFileSync</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">  .<span class="title function_">split</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> [item.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">3</span>), item.<span class="title function_">slice</span>(<span class="number">5</span>).<span class="title function_">split</span>(<span class="string">&quot; &quot;</span>)]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> d = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">dfs</span> = (<span class="params">p, mask</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (p === <span class="string">&quot;out&quot;</span>) <span class="keyword">return</span> mask === <span class="number">3</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  d[p] ??= <span class="title class_">Array</span>(<span class="number">4</span>).<span class="title function_">fill</span>(<span class="literal">undefined</span>);</span><br><span class="line">  <span class="keyword">if</span> (d[p][mask] !== <span class="literal">undefined</span>) <span class="keyword">return</span> d[p][mask];</span><br><span class="line"></span><br><span class="line">  d[p][mask] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">const</span> idx = data.<span class="title function_">findIndex</span>(<span class="function"><span class="params">item</span> =&gt;</span> item[<span class="number">0</span>] === p);</span><br><span class="line">  </span><br><span class="line">  data[idx][<span class="number">1</span>].<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item === <span class="string">&quot;dac&quot;</span>) d[p][mask] += <span class="title function_">dfs</span>(item, mask | <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (item === <span class="string">&quot;fft&quot;</span>) d[p][mask] += <span class="title function_">dfs</span>(item, mask | <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">else</span> d[p][mask] += <span class="title function_">dfs</span>(item, mask);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> d[p][mask];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ans = <span class="title function_">dfs</span>(<span class="string">&quot;svr&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ans);</span><br><span class="line"><span class="comment">// 490695961032000</span></span><br></pre></td></tr></table></figure><h2 id="总结">总结</h2><p>这次活动总的来说学到了不少新东西，不过最大的收获倒不是巩固了算法知识，而是对 JavaScript 这个语言更加熟悉了。了解了浅拷贝的逆天机制，函数传参直接影响原变量的精妙设计，还有两个相同数组不一定取等的神秘构思。也算是理解为什么那么多人讨厌 JavaScript。不过好的一面也是存在的，比如说各种方便的现成函数，简单易用的数据结构等等。有种又爱又恨的感觉。</p><p>没做出来的题目，以后有时间的话可能会补。不过按照我的性格大概率没机会就是了（笑</p>]]></content:encoded>
      
      
      
      <category domain="https://blog.xenlyra.cc/tags/JavaScript/">JavaScript</category>
      
      <category domain="https://blog.xenlyra.cc/tags/%E7%AE%97%E6%B3%95/">算法</category>
      
      <category domain="https://blog.xenlyra.cc/tags/Advent-of-Code/">Advent of Code</category>
      
      
      <comments>https://blog.xenlyra.cc/aoc2025/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Git 使用心得</title>
      <link>https://blog.xenlyra.cc/git/</link>
      <guid>https://blog.xenlyra.cc/git/</guid>
      <pubDate>Sat, 06 Dec 2025 05:04:28 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;使用 Git 会经常遇到各种奇怪需求，在这里分享一下，可能会持续更新？&lt;/p&gt;
&lt;h2 id=&quot;改动历史提交记录&quot;&gt;改动历史提交记录&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;前排提醒：修改历史记录会对这条记录之后的 commit 都产生影响，具体表现为哈希值被修改，</description>
        
      
      
      
      <content:encoded><![CDATA[<p>使用 Git 会经常遇到各种奇怪需求，在这里分享一下，可能会持续更新？</p><h2 id="改动历史提交记录">改动历史提交记录</h2><blockquote><p>前排提醒：修改历史记录会对这条记录之后的 commit 都产生影响，具体表现为哈希值被修改，所以此功能不应该被滥用。如果你修改了已经推送到云端的内容，请尽量在 push 命令后面加上 <code>--force-with-lease</code></p></blockquote><blockquote><p>你可能会在 rebase 过程中遇到冲突问题，这是正常现象，你需要对冲突的部分进行手动调整，然后执行 <code>git add</code> 和 <code>git rebase --continue</code></p></blockquote><p>如果你想对分支内的某条记录进行修改的话，可以先复制这个 commit <strong>前一条记录</strong>的哈希值，然后输入下面的命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rebase -i &lt;<span class="built_in">hash</span>&gt;</span><br></pre></td></tr></table></figure><p>就会弹出一个窗口，展示了这个提交之后的所有 commit 列表，<strong>注意不包含他自身</strong>。至于为什么，可以从 rebase 的字面意思来理解。如果我们填入的记录就是所谓的 base 的话，这个命令要做的就是改变这个 base 后面的内容，他本身自然就不需要被包含。</p><p>如果你正在跟着做的话，你可能会看到与下图类似的结构，接下来的操作都是通过将其中的 <code>pick</code> 改为其他的指令，必要时更改记录的位置顺序实现的。</p><p><img src="https://img.xenlyra.cc/QQ_1765012212453.png" /></p><p>除了直接复制 hash 值，我们还可以使用相对引用。比如你想更改的是第五个记录，只需将前面命令的 <code>&lt;hash&gt;</code> 部分更改为 <code>HEAD~5</code>，HEAD 是 0-base 的，所以他的含义与第六条记录的 hash 值等效。最终的效果自然也一样。</p><p>那么上面这些基本已经覆盖了 99% 的场景了，但是如果我们想更改这个仓库的第一个，也就是最老的记录，他并没有父记录，该怎么办？可以这样：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rebase -i --root</span><br></pre></td></tr></table></figure><h3 id="改历史注释">改历史注释</h3><p>如果你只想修改最后一次提交的内容，那么很幸运，直接输入这行命令就能便捷的修改</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit --amend -m &lt;commit&gt;</span><br></pre></td></tr></table></figure><p>然而如果这个 commit 的前面存在别的提交，就要用到前面讲到的 rebase 方法，将目标提交前面的 pick 删掉，改为 reword 或简写 r，关闭窗口，然后在新弹出的窗口中进行修改操作。</p><h3 id="改历史内容">改历史内容</h3><p>仍然是 rebase， 将 pick 改为 edit 或 e，就可以修改内容</p><p>修改完成后输入下面的命令即可：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit --amend --no-edit</span><br><span class="line">git rebase --<span class="built_in">continue</span></span><br></pre></td></tr></table></figure><p>具体含义就是将修改内容合并到最后一个 commit，并继续 rebase 流程</p><h3 id="合并提交记录">合并提交记录</h3><p>将 pick 改为 squash 或 s，就可以合并到他的前一条记录中。如果想要合并的两条记录并不相邻呢？我们可以剪切较新的那条记录，插入到目标记录的下面，然后将 pick 改为 squash 即可</p><p>squash 是强制要求我们修改注释的，如果我们不想修改注释，可以使用 fixup 指令，他可以只将内容并入目标记录，不影响注释</p><p>如果我们一开始就明确了这个记录应该被合并，可以使用以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git commit --fixup=&lt;<span class="built_in">hash</span>&gt;</span><br><span class="line">git rebase -i --autosquash &lt;前一个记录的<span class="built_in">hash</span>&gt;</span><br></pre></td></tr></table></figure><p>这样 git 就能帮我们自动排好顺序并标注 fixup，我们只需要点关闭就好了</p><h3 id="删除提交记录">删除提交记录</h3><p>将 pick 改为 drop 或 d</p><h3 id="拆分提交记录">拆分提交记录</h3><p>这个需求没有现成的轮子，需要配合其他的指令。先把目标记录改成 edit，然后输入：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset HEAD~1</span><br></pre></td></tr></table></figure><p>将代码全部恢复到工作区，然后挑选文件分批提交即可。如果需要对某个文件进行更细致的更改，可以自己手动调整</p><h2 id="单独恢复某个文件">单独恢复某个文件</h2><p>如果只想将单独的文件回退到某个 commit 的状态，可以使用 restore 命令，使用方法非常简单：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git restore --<span class="built_in">source</span>=&lt;<span class="built_in">hash</span>&gt; &lt;file&gt;</span><br></pre></td></tr></table></figure><h2 id="改动分支基点">改动分支基点</h2><p>如果你因为某些原因想要将分支基点转移到一个新的节点，rebase 同样能胜任这个工作。</p><p>步骤也很简单，首先切换到需要变基的分支，然后执行 rebase 命令即可，以转移到 master 最新节点为例:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout &lt;branch&gt;</span><br><span class="line">git rebase master</span><br></pre></td></tr></table></figure><h2 id="将某个记录应用到新的分支">将某个记录应用到新的分支</h2><p>切换到这个分支，然后使用 cherry-pick：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout &lt;branch&gt;</span><br><span class="line">git cherry-pick &lt;<span class="built_in">hash</span>&gt;</span><br></pre></td></tr></table></figure><h2 id="回退记录">回退记录</h2><p>如果你在操作的时候遇到了问题，且比较难解决时，比较好的办法就是回退。我们可以输入：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reflog</span><br></pre></td></tr></table></figure><p>来查看修改记录，复制目标记录的 hash 值后输入：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard &lt;<span class="built_in">hash</span>&gt;</span><br></pre></td></tr></table></figure><p>就顺利的完成了一次回退</p>]]></content:encoded>
      
      
      
      <category domain="https://blog.xenlyra.cc/tags/Git/">Git</category>
      
      
      <comments>https://blog.xenlyra.cc/git/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>个人的 RSS 折腾记录</title>
      <link>https://blog.xenlyra.cc/rss/</link>
      <guid>https://blog.xenlyra.cc/rss/</guid>
      <pubDate>Fri, 03 Oct 2025 14:52:18 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;这几天配置 RSS 花了我很多的精力，大作业都没心思做了，感觉可以说的地方还蛮多的，这么好的机会，还不拿来水一篇？&lt;/p&gt;
&lt;p&gt;先直接看下最终的成果图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img.xenlyra.cc/3f2e065b8b3fc7db3</description>
        
      
      
      
      <content:encoded><![CDATA[<p>这几天配置 RSS 花了我很多的精力，大作业都没心思做了，感觉可以说的地方还蛮多的，这么好的机会，还不拿来水一篇？</p><p>先直接看下最终的成果图：</p><p><img src="https://img.xenlyra.cc/3f2e065b8b3fc7db34719181cec012a0.webp" title="怎么全是音游啊？唉，音批" /></p><p>还是很爽的</p><h2 id="什么是-rss">什么是 RSS</h2><p>RSS 是一个基于 XML 的格式规范，它可以将来自各平台的信息用统一的格式表示，借助专用阅读器就可以达到一站式获取信息的效果</p><h2 id="为什么要使用-rss">为什么要使用 RSS</h2><p>不知道大家有没有过这样的经历：虽然关注了一些博主，但是动态中不会显示他们的消息，让你一度以为他似了，直到有一天点进他的主页，才发现他一直在活跃。现在我们可以直接通过 RSS 订阅这个博主的动态，这样就不会被平台的逆天机制恶心到了</p><p>除此之外，以往获取信息需要前往不同的平台，跳转到各种页面，这本身就是一个很繁琐的流程，而且很容易出现遗漏。RSS 通过将信息聚合起来，可以优雅地解决这个问题</p><h2 id="那还说啥了开搞">那还说啥了，开搞！</h2><h3 id="选一款-rss-阅读器">选一款 RSS 阅读器</h3><p>经过一番了解，我得知阅读器大体包括本地阅读器和在线阅读器。在线阅读器的优势在于可以实时更新，如果订阅源更新内容比较多，本地阅读器可能会出现遗漏信息的情况，不过基本上只要每天都上线刷新一下也没什么大问题</p><p>网上能找到的在线阅读器基本上都需要付费才能享受全部功能，我最终选择的是本地阅读器，所以不会过多介绍。除此之外还有自己部署阅读器的做法，不过花钱用 VPS 部署一个阅读器感觉多少有些没必要，如果只是本地部署的话，那就跟本地阅读器没什么区别了，所以把他排除掉了，<del>如果是富哥当我没说</del></p><h3 id="feedly"><a href="https://feedly.com/">Feedly</a></h3><p>推荐的唯一一个在线阅读器，界面非常的美观，是我阅读器里面用下来体验最舒适的一个。它还支持自动生成 RSS，如果一些网站没有提供 RSS 订阅，这个功能可以帮你爬取并处理信息，还提供了一个可视化的界面让你手动调整，十分高效，当然这个功能是付费计划专属的。缺点就是免费计划功能阉割，且只支持 100 个订阅源和 3 个文件夹，要想用的舒服还是得付费，如果你可以承受一个月 50 上下的花销，可以选择这一个阅读器</p><p><img src="https://img.xenlyra.cc/9fa2ed029a2574ff4747bf98fb02045b.webp" title="美观的页面" /></p><h3 id="irreader"><a href="https://irreader.fatecore.com/">Irreader</a></h3><p>本地阅读器，功能齐全，同样支持自动生成 RSS，最大亮点就是配备了十分完善的推送系统。可以选择弹窗提醒，也支持通过邮件、钉钉、微信、Telegram 等方式推送，不过除了弹窗以外的几乎所有功能都需要 VIP，价格不低，免费用户只能订阅 10 个 RSS，加上这款软件的颜值实在不能说好看，最后也是果断放弃了</p><h3 id="folo"><a href="https://folo.is/">Folo</a></h3><p>与 RSSHub（开源的 RSS 源生成和分享平台，后面会讲）出自同一制作组，虽然没有 Irreader 那样强大的推送服务，但是他拥有用户间互相分享的数量庞大的 RSS 源，界面也比较漂亮，通过分享自己的 RSS 源还有机会拿到赏金，属于是非常全面的一款产品</p><p>至于为什么没有选择它，主要是因为它太占内存了，一开始安装好大概有 700MB，用了没一会就接近一个 G 了，虽然它提供了很多的功能，但是跟阅读体验没有太大关系，于是我也忍痛把它卸载，选择了接下来这款更加轻量化的阅读器</p><h3 id="fluent-reader"><a href="https://github.com/yang991178/fluent-reader">Fluent Reader</a></h3><p>我现在正在用的一款，也是在文章开始展示的阅读器，个人认为是本地阅读器 UI 巅峰，阅读体验没的说。然而缺点也比较突出，就是功能比较简陋。上面提到的消息推送、分享订阅源、自动生成 RSS 一概没有，甚至没有最小化托盘和开机自启。属于是阅读器丁真，除了颜值啥也没有。好在从爬取订阅源到阅读的这一整套流程做的还是很完善的，一句话来说就是，够用！</p><p>正如前文所言，它占用内存相对较小，大概 200MB 多一点，比其他阅读器小很多，也是我选择这款阅读器的重要原因</p><p><del>说起来这些阅读器怎么都是 F 字辈的</del></p><h3 id="订阅-rss-源">订阅 RSS 源</h3><h4 id="部署-rsshub">部署 RSSHub</h4><p>选好心仪的阅读器后，接下来就要去寻找 RSS 源了。一般来讲博客站点都会提供 RSS 订阅的服务，但是 b 站，油管这样的平台并不会直接提供，需要自己制作 RSS。这时就要用到上文提到的 <a href="https://docs.rsshub.app/zh/">RSSHub</a> 了，开发者会将制作好的 RSS 生成代码放在这里，借助服务器路由就能够订阅各大平台的 RSS。如果没有找到想订阅的网站，也可以通过封装好的函数自己制作</p><p>官方提供了一个实例供我们使用，我们可以直接用它来订阅 RSS，然而它并不能完全满足我们的要求。因为官方的服务器位于美国，加上访问人数多，速度会很慢，有时甚至不响应。还有就是无法自主配置环境变量，有些需要 token 的路由无法使用。为了更好的满足自己的需求，我决定自己部署一个 RSSHub</p><p>官方文档中给了很多平台的部署方法，我最后选择了 Zeabur，原因说来也简单，它每个月会给五美元的免费额度，是除 Vercel 外给的最多的。文档作者也很贴心，提供了一键部署的按钮，我只需要配置一下域名就好了，整个过程十分愉快</p><p>经过测试，如果正常使用的话，每天的费用会在 0.1 美元左右浮动，足够挺过一个月了</p><p>部署过程中也是遇到了很多或大或小的问题，都拿来说一下</p><h4 id="油管推送内容重复">油管推送内容重复</h4><p>我在用 RSSHub 订阅油管频道的时候，发现相同的内容，每次刷新后返回的 RSS 发布时间不一样，导致一个信息会在阅读器中多次出现。我百思不得其解，于是去 Github 上提了 issue，也是我的 first issue。没一会就收到了回复，原来是人工智能 Dosu 回答了我的问题。它说我没在环境变量中配置 token，而第三方的爬取工具只能返回“xxx 小时前”格式的内容，就会出现我这样的情况</p><p>我一听感觉很有道理，按照它说的配置，果然不重复了，然后 close 了这个 issue。虽然我在文档中看到了这个配置项，但因为标的是 optional，想着多一事不如少一事就没有搞。果然以后还是不能偷懒啊</p><p>悲催的是我在接下来又提了一个 issue，然后贡献了自己的第一个 pr，感慨万千，如果这俩顺序反过来该多好</p><h4 id="taptap-部分游戏订阅失败">Taptap 部分游戏订阅失败</h4><p>既然要整理信息，那肯定少不了游戏资讯，有的 b 站官号动态除了更新情报外可能还会推送其他内容，不是我想看的东西，我还需要一个更加干净纯粹的情报站。很快我就把眼光放在了 Taptap 上面，如果有官方入驻的话，这里的信息还是比较及时的</p><p>然而我在订阅 Phigros 的官方动态时，发生了这样的报错（找不到图了先将就一下吧）：</p><p><code>TypeError: Cannot read properties of undefined (reading 'id_str')</code></p><p>通过格式来看，这个报错很明显是 JS 返回的。也就是说，是代码发生了问题。我们先来看看这部分处理函数的源码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">handler</span>(<span class="params">ctx</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> lang = ctx.<span class="property">req</span>.<span class="title function_">param</span>(<span class="string">&#x27;lang&#x27;</span>) ?? <span class="string">&#x27;zh_CN&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> appId = ctx.<span class="property">req</span>.<span class="title function_">param</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> appData = <span class="keyword">await</span> <span class="title function_">appDetail</span>(appId, lang);</span><br><span class="line">    <span class="keyword">const</span> type = ctx.<span class="property">req</span>.<span class="title function_">param</span>(<span class="string">&#x27;type&#x27;</span>) ?? <span class="string">&#x27;feed&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> sort = ctx.<span class="property">req</span>.<span class="title function_">param</span>(<span class="string">&#x27;sort&#x27;</span>) ?? <span class="string">&#x27;created&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> groupId = appData.<span class="property">group</span>.<span class="property">id</span>;</span><br><span class="line">    <span class="keyword">const</span> appImg = appData.<span class="property">app</span>.<span class="property">icon</span>.<span class="property">original_url</span> || appData.<span class="property">app</span>.<span class="property">icon</span>.<span class="property">url</span>;</span><br><span class="line">    <span class="keyword">const</span> appName = appData.<span class="property">app</span>.<span class="property">title</span>;</span><br><span class="line">    <span class="keyword">const</span> url = <span class="string">`<span class="subst">$&#123;getRootUrl(<span class="literal">false</span>)&#125;</span>/webapiv2/feed/v7/by-group?group_id=<span class="subst">$&#123;groupId&#125;</span>&amp;type=<span class="subst">$&#123;type&#125;</span>&amp;sort=<span class="subst">$&#123;sort&#125;</span>&amp;<span class="subst">$&#123;X_UA(lang)&#125;</span>`</span>;</span><br><span class="line">    <span class="keyword">const</span> topicsList = <span class="keyword">await</span> <span class="title function_">ofetch</span>(url);</span><br><span class="line">    <span class="keyword">const</span> list = topicsList.<span class="property">data</span>.<span class="property">list</span>;</span><br><span class="line">    <span class="keyword">const</span> out = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(</span><br><span class="line">        list.<span class="title function_">map</span>(<span class="function">(<span class="params">&#123; moment &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> link = moment.<span class="property">sharing</span>.<span class="property">url</span>;</span><br><span class="line">            <span class="keyword">return</span> cache.<span class="title function_">tryGet</span>(link, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">                <span class="keyword">const</span> author = moment.<span class="property">author</span>.<span class="property">user</span>.<span class="property">name</span>;</span><br><span class="line">                <span class="keyword">const</span> topicId = moment.<span class="property">topic</span>.<span class="property">id_str</span>;</span><br><span class="line">                <span class="comment">// raw_text sometimes is &quot;&quot; so || is better than ??</span></span><br><span class="line">                <span class="keyword">const</span> title = moment.<span class="property">topic</span>.<span class="property">title</span> || moment.<span class="property">topic</span>.<span class="property">summary</span>.<span class="title function_">split</span>(<span class="string">&#x27; &#x27;</span>)[<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">let</span> description = moment.<span class="property">topic</span>.<span class="property">summary</span> || <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">                <span class="keyword">if</span> (moment.<span class="property">topic</span>.<span class="property">pin_video</span>) &#123;</span><br><span class="line">                    description += <span class="title function_">videoPost</span>(moment.<span class="property">topic</span>.<span class="property">pin_video</span>);</span><br><span class="line">                    <span class="keyword">if</span> (moment.<span class="property">topic</span>.<span class="property">footer_images</span>?.<span class="property">images</span>) &#123;</span><br><span class="line">                        description += <span class="title function_">imagePost</span>(moment.<span class="property">topic</span>.<span class="property">footer_images</span>.<span class="property">images</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    description = <span class="keyword">await</span> <span class="title function_">topicPost</span>(appId, topicId, lang);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> &#123;</span><br><span class="line">                    title,</span><br><span class="line">                    description,</span><br><span class="line">                    author,</span><br><span class="line">                    link,</span><br><span class="line">                    <span class="attr">pubDate</span>: <span class="title function_">parseDate</span>(moment.<span class="property">created_time</span>, <span class="string">&#x27;X&#x27;</span>),</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> ret = &#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">`<span class="subst">$&#123;appName&#125;</span> - <span class="subst">$&#123;typeMap[type][lang]&#125;</span> - TapTap 论坛`</span>,</span><br><span class="line">        <span class="attr">link</span>: <span class="string">`<span class="subst">$&#123;getRootUrl(<span class="literal">false</span>)&#125;</span>/app/<span class="subst">$&#123;appId&#125;</span>/topic?type=<span class="subst">$&#123;type&#125;</span>&amp;sort=<span class="subst">$&#123;sort&#125;</span>`</span>,</span><br><span class="line">        <span class="attr">image</span>: appImg,</span><br><span class="line">        <span class="attr">item</span>: out.<span class="title function_">filter</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item !== <span class="string">&#x27;&#x27;</span>),</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ctx.<span class="title function_">set</span>(<span class="string">&#x27;json&#x27;</span>, &#123;</span><br><span class="line">        ...ret,</span><br><span class="line">        appId,</span><br><span class="line">        groupId,</span><br><span class="line">        topicsList,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>大体的逻辑是，获取路由中传入的参数，然后发往 Taptap 的 API 接口，获取到帖子列表后，对帖子进行逐个处理，最终返回 RSS。访问 id_str 的地方只有一处，就是 topicId 的声明部分，它的作用是通过请求这个 id 进一步获取帖子的具体内容，包括贴文和图片</p><p>因为我的 Milthm 订阅也是用的这个路由，没有任何问题，所以我推断可能发生了某个特殊情况，导致 json 结构不一致，引发了报错。为此我手搓 url 拿到了响应信息，然后<del>拿显微镜一行一行观察</del>发现果然有一个帖子不符合规范。这个帖子因为转发了其他的帖子，id_str 用的是被转发帖子的，而且被转移到了其他的地方</p><p>既然发现了问题，改起来就容易了。我先是去提了一个 issue，探讨接下来的解决方案，得到的答复是将正文和被转发文章的内容全部展示出来。然后我从凌晨一点开始写代码，到了四点完成编写并通过测试，提交 <a href="https://github.com/DIYgod/RSSHub/pull/20220">PR</a>，很快啊就被合并了，不亏是歪果仁大半夜的回复效率就是高。通过的一瞬间倦意一扫而空，躺在床上兴奋的睡不着，参与开源的乐趣大概就在于此吧</p><p>关于 json 具体结构以及修改后的代码，感兴趣的自己去看吧，篇幅原因不展示了</p><p>修改后的代码其实还是有缺陷的。因为缺乏实例，没有涵盖到转发视频的情况，届时可能不会显示视频，甚至还是会报错，那时就需要进一步修改了</p><h4 id="b-站订阅视频的风控问题">b 站订阅视频的风控问题</h4><p>其实订阅 b 站视频的步骤非常简单，只要在环境变量中添加 token，然后在阅读器中订阅相应的路由就可以了。然而问题就出在更新 token 这个步骤上，b 站的 token 更新频率很频繁，更新之后原来的 token 就失效了，无法用来获取信息，如果一两天手动更换一次 token 的话会很麻烦。于是我在网上找到了这个 <a href="https://github.com/DIYgod/RSSHub/issues/18019">issue</a>，有人提到用无痕模式拿到 token 之后能保持较长时间的有效期，我在别的地方还看到借助 CookieCloud 编写脚本实时更新的，但是嘛...哎呀太麻烦懒得搞了，就订阅了一个视频源不想大动干戈，所以最后还是选择手动更新</p><p>虽然有一点小小的缺憾，综合来看使用体验已经非常令我满意了</p><h2 id="尾声">尾声</h2><p>把这些能想到的东西都安顿好后，我也算是从火星搬回地球了，终于不会再错过游戏更新的信息。找资料的过程也额外发现了不少优质的博客，顺手都添加了订阅。不得不感慨这些技术真的大大方便了人们的生活，希望以后能多多学习吧</p>]]></content:encoded>
      
      
      
      <category domain="https://blog.xenlyra.cc/tags/RSS/">RSS</category>
      
      
      <comments>https://blog.xenlyra.cc/rss/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Hello World</title>
      <link>https://blog.xenlyra.cc/hello-world/</link>
      <guid>https://blog.xenlyra.cc/hello-world/</guid>
      <pubDate>Mon, 24 Feb 2025 11:34:11 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot;&gt;documentation&lt;/a&gt; for</description>
        
      
      
      
      <content:encoded><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="quick-start">Quick Start</h2><h3 id="create-a-new-post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="run-server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="generate-static-files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="deploy-to-remote-sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content:encoded>
      
      
      
      
      <comments>https://blog.xenlyra.cc/hello-world/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
